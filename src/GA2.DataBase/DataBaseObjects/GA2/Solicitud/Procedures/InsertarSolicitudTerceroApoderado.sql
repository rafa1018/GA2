IF OBJECT_ID('InsertarSolicitudTerceroApoderado', 'P')>0
BEGIN
	DROP PROCEDURE InsertarSolicitudTerceroApoderado
END
GO
CREATE PROCEDURE InsertarSolicitudTerceroApoderado
	@SOL_ID_FK						UNIQUEIDENTIFIER,
	@TID_ID_FK						INT,
	@TER_TIPO_TERCERO_FK			INT = NULL,
	@NUMERO_DOCUMENTO				VARCHAR(16),
	@NOMBRE_RAZON_SOCIAL			VARCHAR(100),
	@TER_PARENTESCO					INT = NULL,
	@TER_ESAUTORIZADO				BIT = NULL,
	@TER_CREATEDOPOR				UNIQUEIDENTIFIER
AS
BEGIN

	DECLARE @ID UNIQUEIDENTIFIER
	SET @ID = NEWID()
	
	INSERT INTO TER_TERCERO
	(
		TER_ID,
		TER_TIPO_TERCERO_FK,
		SOL_ID_FK,
		TID_ID_FK,
		TER_NUMERO_DOCUMENTO,
		TER_NOMBRE_RAZON_SOCIAL,
		TER_PARENTESCO,
		TER_ESAUTORIZADO,
		TER_ESTADO,
		TER_CREATEDOPOR,
		TER_FECHACREACION
	) 
	VALUES (
		@ID,
		@TER_TIPO_TERCERO_FK,
		@SOL_ID_FK,
		@TID_ID_FK,
		@NUMERO_DOCUMENTO,
		@NOMBRE_RAZON_SOCIAL,
		@TER_PARENTESCO,
		@TER_ESAUTORIZADO,
		1,
		@TER_CREATEDOPOR,
		GETDATE()
	)

	SELECT
		@ID AS TER_ID,
		@SOL_ID_FK AS SOL_ID_FK,
		@TID_ID_FK AS TID_ID_FK,
		@NUMERO_DOCUMENTO AS TER_NUMERO_DOCUMENTO, 
		@NOMBRE_RAZON_SOCIAL AS TER_NOMBRE_RAZON_SOCIAL
	FROM TER_TERCERO WHERE TER_ID = @ID
END